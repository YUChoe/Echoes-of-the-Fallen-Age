# 구현 계획

- [x] 1. 프로젝트 구조 및 기본 설정 구성

  - 프로젝트 디렉토리 구조 생성 (src, tests, static 폴더)
  - requirements.txt 파일 생성 (aiohttp, aiosqlite 등 의존성)
  - 기본 설정 파일 및 환경 변수 설정
  - _요구사항: 1.1, 7.4_

- [x] 2. SQLite 데이터베이스 스키마 및 연결 구현

  - 데이터베이스 스키마 생성 스크립트 작성
  - 데이터베이스 연결 및 초기화 클래스 구현
  - 기본 CRUD 연산을 위한 베이스 리포지토리 클래스 작성
  - _요구사항: 9.1, 9.3, 9.4_

- [x] 3. 핵심 데이터 모델 구현

  - Player, Character, Room, GameObject 데이터 클래스 정의
  - 각 모델에 대한 유효성 검증 메서드 구현
  - 모델 간 관계 및 참조 무결성 처리
  - _요구사항: 2.2, 2.3, 6.1_

- [x] 4. 다국어 지원 시스템 구현

  - I18nManager 클래스 구현 (영어/한국어 지원)
  - 번역 텍스트 로딩 및 캐싱 시스템
  - 로케일별 텍스트 반환 메서드 구현
  - _요구사항: 10.1, 10.2, 10.3, 10.6_

- [x] 5. 플레이어 인증 시스템 구현

  - 비밀번호 해싱 및 검증 (bcrypt 사용)
  - 플레이어 계정 생성 및 로그인 로직
  - 세션 관리 및 인증 상태 유지
  - _요구사항: 2.1, 2.2, 2.3, 2.4_

- [x] 6. aiohttp 웹 서버 기본 구조 구현

  - MudServer 클래스 생성 및 서버 시작/중지 메서드
  - 정적 파일 서빙 핸들러 (HTML, CSS, JS)
  - 기본 라우팅 설정 및 미들웨어 구성
  - Pico.css 기반 현대적 웹 인터페이스 구현
  - _요구사항: 1.1, 1.2, 1.3_

- [x] 7. WebSocket 연결 및 세션 관리 구현

  - WebSocket 핸들러 구현 및 연결 관리
  - Session 클래스 구현 (플레이어-WebSocket 매핑)
  - 연결 해제 시 세션 정리 로직
  - SessionManager를 통한 다중 세션 관리
  - 기본 게임 명령어 구현 (help, who, stats, quit)
  - _요구사항: 2.1, 7.2_

- [x] 8. 게임 엔진 코어 및 이벤트 시스템 구현

  - GameEngine 메인 클래스 구현
  - EventBus를 통한 이벤트 발행/구독 시스템
  - 플레이어 세션 추가/제거 및 방 브로드캐스트 기능
  - 이벤트 타입 정의 및 이벤트 히스토리 관리
  - 서버와 GameEngine 완전 통합
  - _요구사항: 4.1, 4.2, 6.5_

- [x] 9. 명령어 처리 시스템 구현

  - CommandProcessor 클래스 및 명령어 파싱 로직
  - 기본 명령어들 구현 (say, tell, who, look)
  - 명령어 등록 및 실행 시스템
  - _요구사항: 4.1, 4.2, 4.3, 4.4_

- [x] 10. 게임 세계 관리 시스템 구현

  - WorldManager 클래스 및 방 관리 기능
  - 방 생성, 수정, 조회 메서드 구현
  - 게임 객체 관리 및 위치 추적 시스템
  - _요구사항: 6.1, 6.2, 6.3_

- [x] 11. 플레이어 이동 및 탐색 시스템 구현

  - 방향 명령어 처리 (north, south, east, west)
  - 방 설명 및 출구 정보 표시 로직
  - 이동 시 다른 플레이어들에게 알림 기능
  - _요구사항: 3.1, 3.2, 3.3, 3.4_

- [x] 12. 객체 상호작용 시스템 구현

  - get, drop, inventory, examine 명령어 구현
  - 인벤토리 관리 및 객체 위치 변경 로직
  - 객체 상태 변경 시 실시간 업데이트
  - _요구사항: 5.1, 5.2, 5.3, 5.4_

- [x] 13. 웹 클라이언트 기본 UI 구현

  - HTML 기본 구조 및 CSS 스타일링
  - WebSocket 연결 및 메시지 처리 JavaScript
  - 텍스트 입력창 및 게임 출력 영역 구현
  - _요구사항: 8.1, 8.5_

- [x] 14. 하이브리드 인터페이스 구현

  - 동적 버튼 생성 (출구, 객체, 액션)
  - 텍스트 명령어와 버튼 클릭 통합 처리
  - 자동완성 힌트 시스템 구현
  - _요구사항: 8.2, 8.3, 8.4, 8.5_

- [x] 15. 관리자 기능 구현

  - 실시간 방 생성 및 편집 기능
  - 객체 생성 및 배치 시스템
  - 플레이어 관리 (킥, 밴, 권한 변경)
  - 관리자 웹 UI 패널 구현 (모달 기반)
  - 관리자 명령어와 서버 API 연동
  - **수정 필요**: WorldManager.create_room()에서 Room 객체를 딕셔너리로 변환하여 DB 저장
  - _요구사항: 6.1, 6.2, 6.3, 6.4, 6.5_

- [x] 15.1. 관리자 기능 DB 저장 문제 수정

  - WorldManager.create_room() 메서드에서 Room 객체를 딕셔너리로 변환하여 DB 저장
  - WorldManager.update_room() 메서드 DB 저장 로직 검증
  - WorldManager.create_object() 메서드 DB 저장 로직 검증
  - 관리자 명령어 실행 후 실제 DB 반영 테스트
  - _요구사항: 6.1, 6.2, 6.3_

- [x] 15.2. 관리자 패널 목록 조회 기능 추가

  - 방 목록 조회 API 및 웹 UI 구현
  - 객체 목록 조회 API 및 웹 UI 구현
  - 플레이어 목록 조회 API 및 웹 UI 구현
  - 관리자 패널에 목록 탭 추가 및 실시간 업데이트
  - _요구사항: 6.4, 6.5_

- [x] 16. 플레이어와 객체 상호작용 시스템 구현

  - 플레이어 이동 시 방 내 모든 플레이어에게 입장/퇴장 메시지 전파
  - 플레이어 액션(say, emote, get, drop) 시 같은 방 플레이어들에게 실시간 알림
  - 객체 상태 변경 시 방 내 모든 플레이어에게 업데이트 전송
  - 플레이어 간 상호작용 명령어 구현 (emote, give, follow, whisper, players)
  - 방 내 플레이어 목록 실시간 업데이트 및 웹 UI 반영
  - 플레이어 상태 변경(로그인/로그아웃) 시 전체 알림 시스템
  - **follow 기능 완전 구현**: 무한 재귀 방지, 자동 이동, 연결 해제 시 정리
  - _요구사항: 3.3, 4.2, 5.4, 7.2_

- [x] 17. 플레이어 능력치 시스템 구현

  - **1차 능력치 (기본 스탯)**: STR, DEX, INT, WIS, CON, CHA 데이터 모델 추가
  - **2차 능력치 (파생 스탯)**: HP, MP, STA, ATK, DEF, SPD, RES, LCK, INF 계산 로직 구현
  - Player 모델에 능력치 필드 추가 및 DB 스키마 업데이트
  - 능력치 계산 및 업데이트 메서드 구현 (레벨업, 장비 착용 시)
  - stats 명령어 확장 - 상세 능력치 표시 기능
  - 웹 UI에 능력치 모달 패널 추가 (실시간 업데이트, 반응형 디자인)
  - 능력치 기반 행동 성공률 계산 시스템 구현
  - 데이터베이스 마이그레이션 스크립트 작성 및 실행
  - 모달 기반 UI로 레이아웃 문제 해결
  - _요구사항: 2.2, 2.3, 8.1_

- [x] 18. 고급 인벤토리 시스템 구현

  - **무게 시스템**: 모든 GameObject에 weight 속성 추가 및 DB 스키마 업데이트
  - **용량 제한**: 플레이어별 최대 소지 무게 계산 (STR 기반)
  - **카테고리 분류**: 무기, 방어구, 소모품, 기타 아이템 분류 시스템
  - **장비 슬롯**: 착용 가능한 장비 슬롯 정의 (무기, 갑옷, 액세서리)
  - inventory 명령어 확장 - 카테고리별 정렬, 무게 표시
  - equip/unequip 명령어 구현 - 장비 착용/해제 기능
  - 웹 UI 인벤토리 패널 개선 - 드래그&드롭, 필터링 기능
  - 아이템 사용(use) 명령어 구현 - 소모품 사용 로직
  - _요구사항: 5.1, 5.2, 5.3, 5.4, 8.2_


- [x] 19. 클라이언트 버그수정

  - 화면에 출력 내용 행 변환 처리 안되는 문제
  - 동서남북 이동 버튼이 클라이언트 리팩토링 이후 없어졌음
  - 방에 들어 갔을때 자동으로 look 하는 기능 클라이언트 리팩토링 이후 없어짐
  - 웹소켓 접속이 너무 늦게 되는 경우가 있음


- [ ] 20. 초기 월드 구성

  - **마을 광장 서쪽 성문 생성**: 마을 광장에서 서쪽으로 연결되는 성문 방 추가
  - **8x8 숲 지역 생성**: 성문을 나가면 접근할 수 있는 64개 방으로 구성된 숲 지역
  - **숲 지역 탐험 시스템**: 각 숲 방에 고유한 설명과 특징 부여
  - **방향 연결 시스템**: 숲 내부의 north, south, east, west 이동 경로 구성
  - **경계 처리**: 숲 가장자리에서 더 이상 이동할 수 없는 경계 메시지 구현
  - **초기 데이터 로딩**: 서버 시작 시 월드 데이터 자동 생성 및 로딩
  - 숲 지역 탐험을 위한 기본 게임 객체 배치 (나무, 돌, 열매 등)
  - _요구사항: 6.1, 6.2, 3.1, 3.2_

- [ ] 21. 초기 게임 캐릭터 구성과 상호작용

  - **동쪽 시장 NPC 배치**: 마을 광장 동쪽 시장에 상점 NPC 생성
  - **NPC 데이터 모델**: NPC 클래스 및 대화/거래 시스템 구현
  - **상점 시스템**: 아이템 구매/판매 기능 구현
  - **NPC 상호작용 명령어**: talk, buy, sell, shop 명령어 구현
  - **거래 인벤토리**: NPC별 판매 아이템 목록 및 재고 관리
  - **경제 시스템**: 플레이어 골드/화폐 시스템 추가
  - **대화 시스템**: NPC와의 기본 대화 및 퀘스트 힌트 제공
  - 웹 UI에 NPC 상호작용 패널 추가 (상점 인터페이스)
  - _요구사항: 6.1, 5.1, 5.2, 4.1, 4.2_

- [ ] 22. 클라이언트 고도화

  - **명령어 버튼 시스템**: 모든 게임 명령어(동사)를 버튼으로 표시
  - **객체 버튼 시스템**: 현재 방의 모든 객체(명사)를 버튼으로 표시
  - **동사-명사 조합 인터페이스**: 명령어 버튼과 객체 버튼을 조합하여 완전한 명령 생성
  - **1라인 명령 처리**: 조합된 명령을 하나의 완전한 명령어로 서버에 전송
  - **상태 기반 버튼 활성화**: 현재 상황에 맞는 명령어만 활성화 (예: 인벤토리에 아이템이 있을 때만 drop 활성화)
  - **시각적 피드백**: 선택된 명령어와 객체를 시각적으로 강조 표시
  - **명령어 미리보기**: 조합 중인 명령어를 실시간으로 미리보기 표시
  - 웹 UI에 명령어 조합 패널 추가 (드래그&드롭 또는 클릭 기반)
  - 키보드 단축키와 버튼 조합 시스템 통합
  - _요구사항: 8.2, 8.3, 8.4, 8.5_

- [ ] 23. 전투 시스템

  - 고정 된 특정지역에서 스폰되는 몹 구현
  - 몹은 주변을 로밍하는 타입과 고정된 타입이 있음
  - 몹은 플레이어를 발견하면 먼저 공격하는 어그레시브타입과 플레이어가 먼저 공격하기 전에는 반응하지 않는 패시브 타입이 있음
  - 어그레시브타입 몹은 다른 몹을 발견해도 먼저 공격 함.
  - 감소화 된 D&D 룰을 통한 전투 시스템 구현


- [ ] 22. 오류 처리 및 로깅 시스템 구현

  - 커스텀 예외 클래스들 정의
  - 전역 오류 핸들러 및 로깅 설정
  - 데이터베이스 트랜잭션 오류 처리
  - _요구사항: 7.3, 9.5_

- [ ] 23. 단위 테스트 작성

  - 핵심 컴포넌트들에 대한 단위 테스트
  - 데이터 모델 및 비즈니스 로직 테스트
  - 명령어 처리 및 다국어 시스템 테스트
  - _요구사항: 모든 요구사항의 검증_

- [ ] 24. 통합 테스트 및 시스템 테스트 작성

  - WebSocket 통신 테스트
  - 다중 사용자 시나리오 테스트
  - 실시간 세계 편집 기능 테스트
  - _요구사항: 7.1, 7.2_

- [ ] 25. 배포 준비
  - 설치 및 실행 스크립트 작성
  - 프로덕션 환경 설정 및 보안 강화
  - _요구사항: 1.1, 1.2_
