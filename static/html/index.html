<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Echoes of the Fallen Age</title>
    <link rel="stylesheet" href="/static/css/simple.css">
</head>
<body>
    <!-- 로그인 화면 -->
    <div id="loginScreen" class="screen active">
        <div class="container">
            <h1>Echoes of the Fallen Age</h1>
            <form id="loginForm" class="form">
                <div class="field">
                    <label for="username">사용자명</label>
                    <input type="text" id="username" name="username" required>
                </div>
                <div class="field">
                    <label for="password">비밀번호</label>
                    <input type="password" id="password" name="password" required>
                </div>
                <div class="actions">
                    <button type="submit" class="btn primary">로그인</button>
                    <button type="button" id="registerBtn" class="btn secondary">회원가입</button>
                </div>
            </form>
            <div id="loginMessage" class="message hidden"></div>
        </div>
    </div>

    <!-- 회원가입 화면 -->
    <div id="registerScreen" class="screen">
        <div class="container">
            <h1>회원가입</h1>
            <form id="registerForm" class="form">
                <div class="field">
                    <label for="regUsername">사용자명</label>
                    <input type="text" id="regUsername" name="username" required>
                    <small id="usernameHelp">로딩 중...</small>
                </div>
                <div class="field">
                    <label for="regPassword">비밀번호</label>
                    <input type="password" id="regPassword" name="password" required>
                    <small id="passwordHelp">로딩 중...</small>
                </div>
                <div class="actions">
                    <button type="submit" class="btn primary">회원가입</button>
                    <button type="button" id="loginBtn" class="btn secondary">로그인으로 돌아가기</button>
                </div>
            </form>
            <div id="registerMessage" class="message hidden"></div>
        </div>
    </div>

    <!-- 게임 화면 -->
    <div id="gameScreen" class="screen">
        <div class="game-container">
            <div class="game-output" id="gameOutput">
                <!-- 게임 메시지들이 여기에 표시됨 -->
            </div>

            <div class="game-input-area">
                <div class="quick-commands">
                    <button class="cmd-btn" data-cmd="look">둘러보기</button>
                    <button class="cmd-btn" data-cmd="inventory">인벤토리</button>
                    <button class="cmd-btn" data-cmd="help">도움말</button>
                    <button class="cmd-btn" data-cmd="who">접속자</button>
                    <button id="statsBtn" class="cmd-btn">📊 능력치</button>
                </div>

                <!-- 동적 버튼 영역 (출구와 객체) -->
                <div class="dynamic-buttons" id="dynamicButtons" style="display: none;">
                    <!-- 동적으로 생성되는 버튼들 -->
                </div>

                <div class="input-container">
                    <input type="text" id="commandInput" placeholder="명령어를 입력하세요..." autocomplete="off">
                    <button id="sendBtn" class="btn primary">전송</button>
                </div>
            </div>

            <div class="status-bar">
                <span id="connectionStatus" class="status">연결됨</span>
                <span id="playerInfo" class="player-info"></span>
                <button id="adminBtn" class="btn admin small" style="display: none;">관리자</button>
                <button id="logoutBtn" class="btn secondary small">로그아웃</button>
            </div>
        </div>
    </div>

    <!-- 관리자 모달 -->
    <div id="adminModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>🔧 관리자 패널</h2>
                <button id="closeAdminModal" class="close-btn">&times;</button>
            </div>

            <div class="modal-body">
                <div class="admin-tabs">
                    <button class="tab-btn active" data-tab="rooms">방 관리</button>
                    <button class="tab-btn" data-tab="objects">객체 관리</button>
                    <button class="tab-btn" data-tab="players">플레이어 관리</button>
                </div>

                <!-- 방 관리 탭 -->
                <div id="roomsTab" class="tab-content active">
                    <div class="admin-section">
                        <h3>방 목록</h3>
                        <button id="refreshRooms" class="btn secondary">목록 새로고침</button>
                        <div id="roomsList" class="data-list">
                            <!-- 방 목록이 여기에 표시됨 -->
                        </div>
                    </div>

                    <div class="admin-section">
                        <h3>새 방 생성</h3>
                        <form id="createRoomForm" class="admin-form">
                            <div class="form-row">
                                <input type="text" id="roomId" placeholder="방 ID (예: room_005)" required>
                                <input type="text" id="roomName" placeholder="방 이름" required>
                            </div>
                            <textarea id="roomDescription" placeholder="방 설명 (선택사항)" rows="2"></textarea>
                            <button type="submit" class="btn primary">방 생성</button>
                        </form>
                    </div>

                    <div class="admin-section">
                        <h3>방 편집</h3>
                        <form id="editRoomForm" class="admin-form">
                            <div class="form-row">
                                <input type="text" id="editRoomId" placeholder="방 ID" required>
                                <select id="editProperty" required>
                                    <option value="">편집할 속성 선택</option>
                                    <option value="name">이름</option>
                                    <option value="description">설명</option>
                                </select>
                            </div>
                            <input type="text" id="editValue" placeholder="새 값" required>
                            <button type="submit" class="btn primary">방 편집</button>
                        </form>
                    </div>

                    <div class="admin-section">
                        <h3>출구 생성</h3>
                        <form id="createExitForm" class="admin-form">
                            <div class="form-row">
                                <input type="text" id="fromRoom" placeholder="출발 방 ID" required>
                                <select id="direction" required>
                                    <option value="">방향 선택</option>
                                    <option value="north">북쪽</option>
                                    <option value="south">남쪽</option>
                                    <option value="east">동쪽</option>
                                    <option value="west">서쪽</option>
                                    <option value="up">위쪽</option>
                                    <option value="down">아래쪽</option>
                                    <option value="northeast">북동쪽</option>
                                    <option value="northwest">북서쪽</option>
                                    <option value="southeast">남동쪽</option>
                                    <option value="southwest">남서쪽</option>
                                </select>
                                <input type="text" id="toRoom" placeholder="도착 방 ID" required>
                            </div>
                            <button type="submit" class="btn primary">출구 생성</button>
                        </form>
                    </div>
                </div>

                <!-- 객체 관리 탭 -->
                <div id="objectsTab" class="tab-content">
                    <div class="admin-section">
                        <h3>객체 목록</h3>
                        <button id="refreshObjects" class="btn secondary">목록 새로고침</button>
                        <div id="objectsList" class="data-list">
                            <!-- 객체 목록이 여기에 표시됨 -->
                        </div>
                    </div>

                    <div class="admin-section">
                        <h3>새 객체 생성</h3>
                        <form id="createObjectForm" class="admin-form">
                            <div class="form-row">
                                <input type="text" id="objectId" placeholder="객체 ID (예: sword001)" required>
                                <input type="text" id="objectName" placeholder="객체 이름" required>
                            </div>
                            <div class="form-row">
                                <select id="objectType" required>
                                    <option value="">객체 타입 선택</option>
                                    <option value="item">일반 아이템</option>
                                    <option value="weapon">무기</option>
                                    <option value="armor">방어구</option>
                                    <option value="food">음식</option>
                                    <option value="book">책</option>
                                    <option value="key">열쇠</option>
                                    <option value="treasure">보물</option>
                                    <option value="furniture">가구</option>
                                    <option value="container">상자/컨테이너</option>
                                </select>
                                <input type="text" id="objectLocation" placeholder="위치 ID (현재 방 기본)">
                            </div>
                            <button type="submit" class="btn primary">객체 생성</button>
                        </form>
                    </div>
                </div>

                <!-- 플레이어 관리 탭 -->
                <div id="playersTab" class="tab-content">
                    <div class="admin-section">
                        <h3>플레이어 목록</h3>
                        <div class="form-row">
                            <button id="refreshPlayers" class="btn secondary">목록 새로고침</button>
                            <select id="playerFilter">
                                <option value="all">전체 플레이어</option>
                                <option value="online">온라인만</option>
                                <option value="offline">오프라인만</option>
                                <option value="admin">관리자만</option>
                            </select>
                        </div>
                        <div id="playersList" class="data-list">
                            <!-- 플레이어 목록이 여기에 표시됨 -->
                        </div>
                    </div>

                    <div class="admin-section">
                        <h3>플레이어 추방</h3>
                        <form id="kickPlayerForm" class="admin-form">
                            <div class="form-row">
                                <input type="text" id="kickUsername" placeholder="플레이어명" required>
                                <input type="text" id="kickReason" placeholder="추방 사유 (선택사항)">
                            </div>
                            <button type="submit" class="btn danger">플레이어 추방</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 능력치 모달 -->
    <div id="statsModal" class="modal">
        <div class="modal-content stats-modal-content">
            <div class="modal-header">
                <h2>📊 플레이어 능력치</h2>
                <button id="closeStatsModal" class="close-btn">&times;</button>
            </div>

            <div class="modal-body stats-modal-body">
                <div class="stats-grid">
                    <!-- 기본 정보 -->
                    <div class="stats-section">
                        <h3>🎯 기본 정보</h3>
                        <div class="stat-item">
                            <span class="stat-label">레벨:</span>
                            <span class="stat-value" id="statLevel">1</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">경험치:</span>
                            <span class="stat-value" id="statExp">0 / 100</span>
                        </div>
                        <div class="exp-bar">
                            <div class="exp-fill" id="expFill" style="width: 0%"></div>
                        </div>
                    </div>

                    <!-- 1차 능력치 -->
                    <div class="stats-section">
                        <h3>💪 1차 능력치</h3>
                        <div class="stat-item">
                            <span class="stat-label">힘 (STR):</span>
                            <span class="stat-value" id="statStr">10</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">민첩 (DEX):</span>
                            <span class="stat-value" id="statDex">10</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">지능 (INT):</span>
                            <span class="stat-value" id="statInt">10</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">지혜 (WIS):</span>
                            <span class="stat-value" id="statWis">10</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">체력 (CON):</span>
                            <span class="stat-value" id="statCon">10</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">매력 (CHA):</span>
                            <span class="stat-value" id="statCha">10</span>
                        </div>
                    </div>

                    <!-- 주요 스탯 -->
                    <div class="stats-section">
                        <h3>❤️ 주요 스탯</h3>
                        <div class="stat-item">
                            <span class="stat-label">생명력 (HP):</span>
                            <span class="stat-value" id="statHp">150</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">마나 (MP):</span>
                            <span class="stat-value" id="statMp">105</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">스태미나 (STA):</span>
                            <span class="stat-value" id="statSta">150</span>
                        </div>
                    </div>

                    <!-- 전투 능력 -->
                    <div class="stats-section">
                        <h3>⚔️ 전투 능력</h3>
                        <div class="stat-item">
                            <span class="stat-label">공격력 (ATK):</span>
                            <span class="stat-value" id="statAtk">31</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">방어력 (DEF):</span>
                            <span class="stat-value" id="statDef">20</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">속도 (SPD):</span>
                            <span class="stat-value" id="statSpd">25</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">마법저항 (RES):</span>
                            <span class="stat-value" id="statRes">20</span>
                        </div>
                    </div>

                    <!-- 기타 능력치 -->
                    <div class="stats-section">
                        <h3>💼 기타</h3>
                        <div class="stat-item">
                            <span class="stat-label">운 (LCK):</span>
                            <span class="stat-value" id="statLck">20</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">영향력 (INF):</span>
                            <span class="stat-value" id="statInf">25</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">최대 소지무게:</span>
                            <span class="stat-value" id="statCarryWeight">100kg</span>
                        </div>
                    </div>
                </div>

                <div class="stats-actions">
                    <button class="btn secondary" data-cmd="stats">능력치 새로고침</button>
                    <button class="btn primary" data-cmd="stats 상세">상세 정보 보기</button>
                </div>
            </div>
        </div>
    </div>

    <!-- NPC 상호작용 모달 -->
    <div id="npcModal" class="modal">
        <div class="modal-content npc-modal-content">
            <div class="modal-header">
                <h2 id="npcModalTitle">🧙‍♂️ NPC 상호작용</h2>
                <button id="closeNpcModal" class="close-btn">&times;</button>
            </div>

            <div class="modal-body npc-modal-body">
                <div class="npc-info">
                    <div class="npc-portrait">
                        <div class="npc-avatar" id="npcAvatar">🧙‍♂️</div>
                        <div class="npc-details">
                            <h3 id="npcName">NPC 이름</h3>
                            <p id="npcDescription">NPC 설명</p>
                        </div>
                    </div>
                </div>

                <div class="npc-actions">
                    <div class="action-tabs">
                        <button class="tab-btn active" data-tab="talk">대화</button>
                        <button class="tab-btn" data-tab="shop" id="shopTab" style="display: none;">상점</button>
                    </div>

                    <!-- 대화 탭 -->
                    <div id="talkTab" class="tab-content active">
                        <div class="dialogue-area">
                            <div class="dialogue-history" id="dialogueHistory">
                                <div class="dialogue-message npc">
                                    <strong>NPC:</strong> 안녕하세요! 무엇을 도와드릴까요?
                                </div>
                            </div>
                            <div class="dialogue-actions">
                                <button class="btn primary" onclick="sendNpcCommand('talk')">대화하기</button>
                                <button class="btn secondary" onclick="sendNpcCommand('examine')">자세히 보기</button>
                            </div>
                        </div>
                    </div>

                    <!-- 상점 탭 -->
                    <div id="shopTabContent" class="tab-content">
                        <div class="shop-area">
                            <div class="shop-header">
                                <h4>🛒 상점 목록</h4>
                                <div class="player-gold">
                                    <span>💰 보유 골드: </span>
                                    <span id="playerGold">100</span>
                                    <span> gold</span>
                                </div>
                            </div>

                            <div class="shop-items" id="shopItems">
                                <!-- 상점 아이템들이 여기에 표시됨 -->
                                <div class="loading">상점 목록을 불러오는 중...</div>
                            </div>

                            <div class="shop-actions">
                                <button class="btn primary" onclick="refreshShop()">목록 새로고침</button>
                                <button class="btn secondary" onclick="sendNpcCommand('shop')">상점 보기</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 모듈 스크립트들 -->
    <script src="/static/js/utils/MessageHandler.js"></script>
    <script src="/static/js/modules/UIModule.js"></script>
    <script src="/static/js/modules/AuthModule.js"></script>
    <script src="/static/js/modules/GameModule.js"></script>
    <script src="/static/js/modules/AdminModule.js"></script>
    <script src="/static/js/modules/StatsModule.js"></script>
    <script src="/static/js/modules/NPCModule.js"></script></script>
    <script src="/static/js/core/MudClient.js"></script>
    <script src="/static/js/app.js"></script>
</body>
</html>